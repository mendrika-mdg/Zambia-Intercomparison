Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

wandb: Currently logged in as: mgrakotomanga (mgrakotomanga-university-of-leeds) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.20.1
wandb: Run data is saved locally in ./wandb/run-20251010_134221-wny8ii1d
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run t1-fss
wandb: ⭐️ View project at https://wandb.ai/mgrakotomanga-university-of-leeds/zambia-cast
wandb: 🚀 View run at https://wandb.ai/mgrakotomanga-university-of-leeds/zambia-cast/runs/wny8ii1d
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]

  | Name        | Type               | Params | Mode 
-----------------------------------------------------------
0 | in_proj     | Linear             | 1.4 K  | train
1 | transformer | TransformerEncoder | 793 K  | train
2 | global_proj | Linear             | 640    | train
3 | map_proj    | Linear             | 4.2 M  | train
4 | decoder     | SimpleDecoder      | 3.8 M  | train
5 | criterion   | FSSLoss            | 0      | train
6 | val_auc     | BinaryAUROC        | 0      | train
-----------------------------------------------------------
8.9 M     Trainable params
0         Non-trainable params
8.9 M     Total params
35.436    Total estimated model params size (MB)
66        Modules in train mode
0         Modules in eval mode
[rank: 0] Metric val_fss_9 improved. New best score: -37344.012
[rank: 3] Metric val_fss_9 improved. New best score: -37344.012
[rank: 1] Metric val_fss_9 improved. New best score: -37344.012
[rank: 2] Metric val_fss_9 improved. New best score: -37344.012
Epoch 0, global step 595: 'val_fss_9' reached -37344.01172 (best -37344.01172), saving model to '/home/users/mendrika/Zambia-Intercomparison/models/checkpoints/t1/best-core2map.ckpt' as top 1
[rank: 0] Metric val_fss_9 improved by 17215.857 >= min_delta = 0.001. New best score: -20128.154
[rank: 3] Metric val_fss_9 improved by 17215.857 >= min_delta = 0.001. New best score: -20128.154
[rank: 2] Metric val_fss_9 improved by 17215.857 >= min_delta = 0.001. New best score: -20128.154
[rank: 1] Metric val_fss_9 improved by 17215.857 >= min_delta = 0.001. New best score: -20128.154
Epoch 1, global step 1190: 'val_fss_9' reached -20128.15430 (best -20128.15430), saving model to '/home/users/mendrika/Zambia-Intercomparison/models/checkpoints/t1/best-core2map.ckpt' as top 1
[rank: 1] Metric val_fss_9 improved by 6442.549 >= min_delta = 0.001. New best score: -13685.605
[rank: 3] Metric val_fss_9 improved by 6442.549 >= min_delta = 0.001. New best score: -13685.605
[rank: 0] Metric val_fss_9 improved by 6442.549 >= min_delta = 0.001. New best score: -13685.605
[rank: 2] Metric val_fss_9 improved by 6442.549 >= min_delta = 0.001. New best score: -13685.605
Epoch 2, global step 1785: 'val_fss_9' reached -13685.60547 (best -13685.60547), saving model to '/home/users/mendrika/Zambia-Intercomparison/models/checkpoints/t1/best-core2map.ckpt' as top 1
[rank: 2] Metric val_fss_9 improved by 2444.489 >= min_delta = 0.001. New best score: -11241.116
[rank: 0] Metric val_fss_9 improved by 2444.489 >= min_delta = 0.001. New best score: -11241.116
[rank: 1] Metric val_fss_9 improved by 2444.489 >= min_delta = 0.001. New best score: -11241.116
[rank: 3] Metric val_fss_9 improved by 2444.489 >= min_delta = 0.001. New best score: -11241.116
Epoch 3, global step 2380: 'val_fss_9' reached -11241.11621 (best -11241.11621), saving model to '/home/users/mendrika/Zambia-Intercomparison/models/checkpoints/t1/best-core2map.ckpt' as top 1
[rank: 0] Metric val_fss_9 improved by 1187.574 >= min_delta = 0.001. New best score: -10053.542
[rank: 2] Metric val_fss_9 improved by 1187.574 >= min_delta = 0.001. New best score: -10053.542
[rank: 3] Metric val_fss_9 improved by 1187.574 >= min_delta = 0.001. New best score: -10053.542
[rank: 1] Metric val_fss_9 improved by 1187.574 >= min_delta = 0.001. New best score: -10053.542
Epoch 4, global step 2975: 'val_fss_9' reached -10053.54199 (best -10053.54199), saving model to '/home/users/mendrika/Zambia-Intercomparison/models/checkpoints/t1/best-core2map.ckpt' as top 1
[rank: 1] Metric val_fss_9 improved by 614.395 >= min_delta = 0.001. New best score: -9439.147
[rank: 0] Metric val_fss_9 improved by 614.395 >= min_delta = 0.001. New best score: -9439.147
[rank: 3] Metric val_fss_9 improved by 614.395 >= min_delta = 0.001. New best score: -9439.147
[rank: 2] Metric val_fss_9 improved by 614.395 >= min_delta = 0.001. New best score: -9439.147
Epoch 5, global step 3570: 'val_fss_9' reached -9439.14746 (best -9439.14746), saving model to '/home/users/mendrika/Zambia-Intercomparison/models/checkpoints/t1/best-core2map.ckpt' as top 1
[rank: 1] Metric val_fss_9 improved by 306.022 >= min_delta = 0.001. New best score: -9133.125
[rank: 3] Metric val_fss_9 improved by 306.022 >= min_delta = 0.001. New best score: -9133.125
[rank: 0] Metric val_fss_9 improved by 306.022 >= min_delta = 0.001. New best score: -9133.125
[rank: 2] Metric val_fss_9 improved by 306.022 >= min_delta = 0.001. New best score: -9133.125
Epoch 6, global step 4165: 'val_fss_9' reached -9133.12500 (best -9133.12500), saving model to '/home/users/mendrika/Zambia-Intercomparison/models/checkpoints/t1/best-core2map.ckpt' as top 1
[rank: 1] Metric val_fss_9 improved by 76.843 >= min_delta = 0.001. New best score: -9056.282
[rank: 0] Metric val_fss_9 improved by 76.843 >= min_delta = 0.001. New best score: -9056.282
[rank: 3] Metric val_fss_9 improved by 76.843 >= min_delta = 0.001. New best score: -9056.282
[rank: 2] Metric val_fss_9 improved by 76.843 >= min_delta = 0.001. New best score: -9056.282
Epoch 7, global step 4760: 'val_fss_9' reached -9056.28223 (best -9056.28223), saving model to '/home/users/mendrika/Zambia-Intercomparison/models/checkpoints/t1/best-core2map.ckpt' as top 1
Epoch 8, global step 5355: 'val_fss_9' was not in top 1
Epoch 9, global step 5950: 'val_fss_9' was not in top 1
Epoch 10, global step 6545: 'val_fss_9' was not in top 1
Epoch 11, global step 7140: 'val_fss_9' was not in top 1
[rank: 2] Monitored metric val_fss_9 did not improve in the last 5 records. Best score: -9056.282. Signaling Trainer to stop.
[rank: 1] Monitored metric val_fss_9 did not improve in the last 5 records. Best score: -9056.282. Signaling Trainer to stop.
[rank: 0] Monitored metric val_fss_9 did not improve in the last 5 records. Best score: -9056.282. Signaling Trainer to stop.
[rank: 3] Monitored metric val_fss_9 did not improve in the last 5 records. Best score: -9056.282. Signaling Trainer to stop.
Epoch 12, global step 7735: 'val_fss_9' was not in top 1
